{"version":3,"file":"commonHelpers.js","sources":["../src/js/apiService.js","../src/js/getRefs.js","../src/js/functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '24005703-1514437038890a8f3813970a7';\nconst BASE_URL = 'https://pixabay.com/api';\n\nexport default class PixabayApiService {\n  constructor() {\n    this.searchQuery = '';\n    this.page = 1;\n    this.perPage = 40;\n    this.totalHits = 0;\n  }\n  async fetchPhotos() {\n    const url = `${BASE_URL}/?image_type=photo&orientation=horizontal&safesearch=true&q=${this.searchQuery}&page=${this.page}&per_page=${this.perPage}&key=${API_KEY}`;\n\n    try {\n      const { data } = await axios.get(url);\n      this.totalHits = data.totalHits;\n      this.incrementPage();\n      return data;\n    } catch (error) {\n      console.log(error);\n    }\n  }\n  get query() {\n    return this.searchQuery;\n  }\n  set query(newQuery) {\n    this.searchQuery = newQuery;\n  }\n\n  incrementPage() {\n    this.page += 1;\n  }\n  resetPage() {\n    this.page = 1;\n  }\n\n  getPage() {\n    return this.page;\n  }\n\n  getEndPage() {\n    return Math.ceil(this.totalHits / this.perPage) < this.page;\n  }\n}\n","export default function getRefs() {\n  return {\n    cardContainer: document.querySelector('.gallery'),\n    searchForm: document.getElementById('search-form'),\n  };\n}\n","export function createGalleryMarkup(galleryItems, getMurkup) {\n  return galleryItems\n    .map(photo => {\n      return getMurkup(photo);\n    })\n    .join('');\n}\n\nexport function getGalleryItemMurkup({\n  webformatURL,\n  tags,\n  likes,\n  views,\n  comments,\n  downloads,\n  largeImageURL,\n}) {\n  return `\n      <div class=\"photo-card\">\n        <a class=\"gallery__link\" href=\"${largeImageURL}\">\n          <img class=\"img\" src=${webformatURL} alt=${tags} loading=\"lazy\" />\n        </a>\n        <div class=\"info\">\n          <p class=\"info-item\">\n            <b>Likes</b>\n            <b>${likes}</b>\n          </p>\n          <p class=\"info-item\">\n            <b>Views</b>\n            <b>${views}</b>\n          </p>\n          <p class=\"info-item\">\n            <b>Comments</b>\n            <b>${comments}</b>\n          </p>\n          <p class=\"info-item\">\n            <b>Downloads</b>\n            <b>${downloads}</b>\n          </p>\n        </div>\n    </div>\n      `;\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport PixabayApiService from './js/apiService';\nimport getRefs from './js/getRefs';\n\nconst { cardContainer, searchForm } = getRefs();\nimport { createGalleryMarkup, getGalleryItemMurkup } from './js/functions';\n\nconst pixabayApiService = new PixabayApiService();\n\nsearchForm.addEventListener('submit', onSearch);\n\nconst lightbox = new SimpleLightbox('.gallery a');\n\nfunction onSearch(event) {\n  event.preventDefault();\n\n  const searchQuery = event.target.elements.searchQuery.value.trim();\n\n  pixabayApiService.query = searchQuery;\n\n  if (pixabayApiService.query === '') {\n    clearCardContainer();\n    return;\n  }\n  pixabayApiService.resetPage();\n  clearCardContainer();\n  fetchPhotos();\n}\n\nasync function fetchPhotos() {\n  try {\n    if (pixabayApiService.getEndPage() && pixabayApiService.getPage() > 1) {\n      iziToast.show({\n        message: 'Sorry, there are no more images matching your search.',\n        color: 'red',\n        position: 'topRight',\n      });\n\n      return;\n    }\n    const data = await pixabayApiService.fetchPhotos();\n    if (data.hits.length === 0) {\n      return iziToast.show({\n        message:\n          'Sorry, there are no images matching your search query. Please try again.',\n        color: 'red',\n        position: 'topRight',\n      });\n    } else {\n      const page = pixabayApiService.getPage();\n      if (page <= 2) {\n        iziToast.show({\n          message: `Hooray! We found ${data.totalHits} images.`,\n          color: 'green',\n          position: 'topRight',\n        });\n      }\n      appendPhotosMarkup(data.hits);\n      lightbox.refresh();\n    }\n  } catch (error) {\n    console.log(error);\n  }\n}\n\nfunction appendPhotosMarkup(photos) {\n  cardContainer.insertAdjacentHTML(\n    'beforeend',\n    createGalleryMarkup(photos, getGalleryItemMurkup)\n  );\n}\n\nfunction clearCardContainer() {\n  cardContainer.innerHTML = '';\n}\n\n// ===================================//\n\nconst options = {\n  rootMargin: '150px',\n};\n\nconst callback = entries => {\n  entries.forEach(entry => {\n    if (\n      pixabayApiService.query !== '' &&\n      entry.isIntersecting &&\n      pixabayApiService.getPage() > 1\n    ) {\n      fetchPhotos();\n    }\n  });\n};\n\nlet observer = new IntersectionObserver(callback, options);\n\nconst sentinel = document.getElementById('sentinel');\nobserver.observe(sentinel);\n"],"names":["API_KEY","BASE_URL","PixabayApiService","url","data","axios","error","newQuery","getRefs","createGalleryMarkup","galleryItems","getMurkup","photo","getGalleryItemMurkup","webformatURL","tags","likes","views","comments","downloads","largeImageURL","cardContainer","searchForm","pixabayApiService","onSearch","lightbox","SimpleLightbox","event","searchQuery","clearCardContainer","fetchPhotos","iziToast","appendPhotosMarkup","photos","options","callback","entries","entry","observer","sentinel"],"mappings":"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"}